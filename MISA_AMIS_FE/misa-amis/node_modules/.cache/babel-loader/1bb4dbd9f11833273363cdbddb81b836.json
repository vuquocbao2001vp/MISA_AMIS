{"ast":null,"code":"import axios from 'axios';\nimport ConstApi from '../../constants/api/constApi';\nimport ConstEndpoint from '../../constants/api/constEndpoint';\nimport MTable from '@/components/base/table/MTable.vue';\nimport EmployeeDetail from './EmployeeDetail.vue';\nimport { mapMutations, mapActions, mapGetters } from \"vuex\";\nexport default {\n  components: {\n    MTable,\n    EmployeeDetail\n  },\n\n  data() {\n    return {\n      isHideDetail: true,\n      timeout: null,\n      searchKey: \"\",\n      saveMode: null,\n      employeeSelected: {},\n      isHideToast: true,\n      toastText: \"\",\n      toastType: \"\"\n    };\n  },\n\n  mounted() {\n    this.getEmployeePaging({\n      pageSize: 20,\n      pageNumber: 1\n    });\n  },\n\n  computed: { ...mapGetters([\"employees\", \"employeePaging\"])\n  },\n  methods: { ...mapMutations([\"setEmployeePaging\"]),\n    ...mapActions([\"getEmployeePaging\"]),\n\n    /**\r\n     * Ẩn hiện dialog chi tiết nhân viên\r\n     * Author: VQBao - 11/10/2022\r\n     */\n    hideDetail(mode, isHide, emp) {\n      this.isHideDetail = isHide;\n      this.saveMode = mode;\n      this.employeeSelected = emp;\n    },\n\n    /**\r\n     * Lấy ra từ khóa tìm kiếm sau khi nhập xong input\r\n     * Author; VQBao - 11/10/2022\r\n     */\n    getTextSearch(data) {\n      clearTimeout(this.timeout);\n      var self = this;\n      self.timeout = setTimeout(function () {\n        self.searchKey = data.value;\n      }, 500);\n    },\n\n    /**\r\n     * Load lại dữ liệu\r\n     * Author; VQBao - 11/10/2022\r\n     */\n    loadData(pageSize, pageNumber, searchKey) {\n      this.getEmployeePaging({\n        pageSize: pageSize,\n        pageNumber: pageNumber,\n        searchKey: searchKey\n      });\n    },\n\n    /**\r\n     * Hiện toast mesage\r\n     * Author: VQBao - 11/10/2022\r\n     */\n    showToast(text, type) {\n      var me = this;\n      me.toastType = type;\n      me.toastText = text;\n      me.isHideToast = false;\n      setTimeout(function () {\n        me.isHideToast = true;\n      }, 3000);\n    },\n\n    /**\r\n     * Xuất khẩu nhân viên\r\n     * Author: VQBao - 12/10/2022\r\n     */\n    exportExcelFile() {\n      document.getElementById(\"loader\").style.display = \"block\";\n\n      try {\n        axios({\n          url: ConstApi.EmployeeApi + ConstEndpoint.EmployeeExcel,\n          method: \"GET\",\n          responseType: \"blob\"\n        }).then(response => {\n          var fileURL = window.URL.createObjectURL(new Blob([response.data]));\n          var fileLink = document.createElement(\"a\");\n          fileLink.href = fileURL;\n          fileLink.setAttribute(\"download\", \"Danh_sach_nhan_vien.xlsx\");\n          document.body.appendChild(fileLink);\n          fileLink.click();\n          document.getElementById(\"loader\").style.display = \"none\";\n        }).catch(error => {\n          document.getElementById(\"loader\").style.display = \"none\";\n          this.showToast(error.response.data.errorMsg, 'error');\n        });\n      } catch (error) {\n        document.getElementById(\"loader\").style.display = \"none\";\n        console.log(error);\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["axios","ConstApi","ConstEndpoint","MTable","EmployeeDetail","mapMutations","mapActions","mapGetters","components","data","isHideDetail","timeout","searchKey","saveMode","employeeSelected","isHideToast","toastText","toastType","mounted","getEmployeePaging","pageSize","pageNumber","computed","methods","hideDetail","mode","isHide","emp","getTextSearch","clearTimeout","self","setTimeout","value","loadData","showToast","text","type","me","exportExcelFile","document","getElementById","style","display","url","EmployeeApi","EmployeeExcel","method","responseType","then","response","fileURL","window","URL","createObjectURL","Blob","fileLink","createElement","href","setAttribute","body","appendChild","click","catch","error","errorMsg","console","log"],"sourceRoot":"","sources":["E:\\MisaProject\\MISA_AMIS\\MISA_AMIS_FE\\misa-amis\\src\\pages\\Employee\\PageEmployee.vue"],"sourcesContent":["<template>\r\n  <div class=\"header flex\">\r\n    <div class=\"header-title\">Nhân viên</div>\r\n    <div class=\"header-right\">\r\n        <div @click=\"hideDetail(1, false, {})\"><m-button buttonName=\"Thêm mới nhân viên\" buttonType=\"green\"></m-button></div>\r\n    </div>\r\n  </div>\r\n  <div class=\"toolbar flex\">\r\n    <div class=\"toolbar-right flex\">\r\n        <div class=\"input-search\">\r\n            <DxTextBox \r\n                class=\"control-textbox\"\r\n                placeholder=\"Tìm theo mã, tên nhân viên\"\r\n                value-change-event=\"keyup\"\r\n                @value-changed=\"getTextSearch\"\r\n            />\r\n            <div class=\"icon-textbox flex\"><div class=\"icon-search\"></div></div>\r\n        </div>\r\n        <div class=\"toolbar-icon flex\" @click=\"getEmployeePaging({pageSize: 20, pageNumber: 1, searchKey: ''})\"><div class=\"icon-reload\" title=\"Lấy lại dữ liệu\"></div></div>\r\n        <div class=\"toolbar-icon flex\" @click=\"exportExcelFile\"><div class=\"icon-export\" title=\"Xuất ra Excel\"></div></div>\r\n        <div class=\"toolbar-icon flex\"><div class=\"icon-setting\" title=\"Tùy chỉnh giao diện\"></div></div>\r\n    </div>\r\n  </div>\r\n  <div class=\"grid\">\r\n    <m-table\r\n        :employees=\"employees\"\r\n        :searchKey=\"searchKey\"\r\n        :totalRecords=\"employeePaging.totalRecords\"\r\n        :totalPages=\"employeePaging.totalPages\"\r\n        :pageSize=\"employeePaging.pageSize\"\r\n        :pageNumber=\"employeePaging.pageNumber\"\r\n        @hideDetail=\"hideDetail\"\r\n        @loadData=\"loadData\"\r\n        @showToast=\"showToast\"\r\n    >\r\n    </m-table>\r\n  </div>\r\n  <EmployeeDetail\r\n    :isHide=\"isHideDetail\"\r\n    @hideDetail=\"hideDetail\"\r\n    @loadData=\"loadData\"\r\n    @showToast=\"showToast\"\r\n    :saveMode=\"saveMode\"\r\n    :employeeSelected=\"employeeSelected\"\r\n  />\r\n  <m-toast :isHideToast=\"isHideToast\" :text=\"toastText\" :type=\"toastType\"></m-toast>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport ConstApi from '../../constants/api/constApi'\r\nimport ConstEndpoint from '../../constants/api/constEndpoint'\r\nimport MTable from '@/components/base/table/MTable.vue'\r\nimport EmployeeDetail from './EmployeeDetail.vue'\r\nimport { mapMutations, mapActions, mapGetters } from \"vuex\";\r\n\r\nexport default {\r\n  components: { MTable, EmployeeDetail},\r\n  data() {\r\n    return {\r\n      isHideDetail: true,\r\n      timeout: null,\r\n      searchKey: \"\",\r\n      saveMode: null,\r\n      employeeSelected: {},\r\n      isHideToast: true,\r\n      toastText: \"\",\r\n      toastType: \"\",\r\n    }\r\n  },\r\n  mounted(){\r\n    this.getEmployeePaging({pageSize: 20, pageNumber: 1});\r\n  },\r\n  computed: {\r\n    ...mapGetters([\"employees\", \"employeePaging\"])\r\n  },\r\n  methods: {\r\n    ...mapMutations([\"setEmployeePaging\"]),\r\n    ...mapActions([\"getEmployeePaging\"]),\r\n\r\n    /**\r\n     * Ẩn hiện dialog chi tiết nhân viên\r\n     * Author: VQBao - 11/10/2022\r\n     */\r\n    hideDetail(mode, isHide, emp){\r\n      this.isHideDetail = isHide;\r\n      this.saveMode = mode;\r\n      this.employeeSelected = emp;\r\n    },\r\n\r\n    /**\r\n     * Lấy ra từ khóa tìm kiếm sau khi nhập xong input\r\n     * Author; VQBao - 11/10/2022\r\n     */\r\n    getTextSearch(data) {\r\n      clearTimeout(this.timeout);\r\n      var self = this;\r\n      self.timeout = setTimeout(function () {\r\n        self.searchKey = data.value;\r\n      }, 500);\r\n    },\r\n\r\n    /**\r\n     * Load lại dữ liệu\r\n     * Author; VQBao - 11/10/2022\r\n     */\r\n    loadData(pageSize, pageNumber, searchKey){\r\n      this.getEmployeePaging({pageSize: pageSize, pageNumber: pageNumber, searchKey: searchKey});\r\n    },\r\n\r\n    /**\r\n     * Hiện toast mesage\r\n     * Author: VQBao - 11/10/2022\r\n     */\r\n    showToast(text, type) {\r\n      var me = this;\r\n      me.toastType = type;\r\n      me.toastText = text;\r\n      me.isHideToast = false;\r\n      setTimeout(function () {\r\n        me.isHideToast = true;\r\n      }, 3000);\r\n    },\r\n\r\n    /**\r\n     * Xuất khẩu nhân viên\r\n     * Author: VQBao - 12/10/2022\r\n     */\r\n    exportExcelFile(){\r\n      document.getElementById(\"loader\").style.display = \"block\";\r\n      try {\r\n        axios({\r\n          url: ConstApi.EmployeeApi + ConstEndpoint.EmployeeExcel,\r\n          method: \"GET\",\r\n          responseType: \"blob\",\r\n        }).then((response) => {\r\n          var fileURL = window.URL.createObjectURL(new Blob([response.data]));\r\n          var fileLink = document.createElement(\"a\");\r\n\r\n          fileLink.href = fileURL;\r\n          fileLink.setAttribute(\"download\", \"Danh_sach_nhan_vien.xlsx\");\r\n          document.body.appendChild(fileLink);\r\n          fileLink.click();\r\n          document.getElementById(\"loader\").style.display = \"none\";\r\n        })\r\n        .catch((error) => {\r\n          document.getElementById(\"loader\").style.display = \"none\";\r\n          this.showToast(error.response.data.errorMsg, 'error');\r\n        })\r\n      } catch (error) {\r\n        document.getElementById(\"loader\").style.display = \"none\";\r\n        console.log(error);\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.header {\r\n    padding: 24px 0;\r\n}\r\n.header-title {\r\n    font-size: 24px;\r\n    font-weight: 700;\r\n    color: #111;\r\n    font-family: Misa Font Bold;\r\n    min-width: 125px;\r\n}\r\n.header-right {\r\n  position: absolute;\r\n  right: 10px;\r\n}\r\n.toolbar {\r\n    padding: 16px 16px 16px 4px;\r\n    height: 68px;\r\n    background-color: #fff;\r\n    position: relative;\r\n    box-sizing: border-box;\r\n}\r\n.input-search {\r\n    width: 240px;\r\n    height: 32px;\r\n    box-sizing: border-box;\r\n    position: relative;\r\n    margin-right: 10px;\r\n}\r\n.control-textbox {\r\n    padding-right: 28px;\r\n    width: 100% !important;\r\n}\r\n.icon-textbox {\r\n  position: absolute;\r\n  content: \"\";\r\n  top: 8px;\r\n  right: 10px;\r\n  width: 18px;\r\n  height: 18px;\r\n  z-index: 1;\r\n  justify-content: center;\r\n}\r\n.toolbar-icon {\r\n    width: 24px;\r\n    height: 24px;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n    margin: 0 6px;\r\n}\r\n.icon-reload {\r\n    background: url(./../../assets/img/Sprites.64af8f61.svg) no-repeat -425px -201px;\r\n\twidth: 21px;\r\n\theight: 23px;\r\n}\r\n.icon-reload:hover {\r\n    background: url(./../../assets/img/Sprites.64af8f61.svg) no-repeat -1098px -90px;\r\n\twidth: 20px;\r\n\theight: 21px;\r\n}\r\n.icon-export {\r\n    background: url(./../../assets/img/Sprites.64af8f61.svg) no-repeat -705px -202px;\r\n\twidth: 23px;\r\n\theight: 20px;\r\n}\r\n.icon-export:hover {\r\n    background: url(./../../assets/img/Sprites.64af8f61.svg) no-repeat -1265px -90px;\r\n\twidth: 23px;\r\n\theight: 20px;\r\n}\r\n.icon-setting {\r\n    background: url(./../../assets/img/Sprites.64af8f61.svg) no-repeat -90px -201px;\r\n\twidth: 20px;\r\n\theight: 22px;\r\n}\r\n.icon-setting:hover {\r\n    background: url(./../../assets/img/Sprites.64af8f61.svg) no-repeat -33px -144px;\r\n\twidth: 23px;\r\n\theight: 24px;\r\n}\r\n.toolbar-right {\r\n    justify-content: center;\r\n    position: absolute;\r\n    right: 16px;\r\n}\r\n.grid {\r\n    background-color: #fff;\r\n    height: calc(100vh - 48px - 84px - 68px);\r\n    box-sizing: border-box;\r\n    padding: 1px 30px 0px 20px;\r\n    position: relative;\r\n}\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}